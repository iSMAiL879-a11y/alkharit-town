<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="description" content="بوابة قرية الخريطة، خدمات طبية، زراعية، ومجتمعية على ضفاف نهر الفرات" />
  <meta name="keywords" content="قرية الخريطة, خدمات, الفرات, زراعة, تعليم, فعاليات" />
  <title>بوابة قرية الخريطة</title>
  <link href="https://fonts.googleapis.com/css2?family=Amiri:wght@400;700&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.rtl.min.css" />
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css" />
  <script async src="https://www.googletagmanager.com/gtag/js?id=YOUR_GA_ID"></script>
  <script src="https://cdn.jsdelivr.net/npm/fullcalendar@6.1.8/index.global.min.js"></script>
  <script async src="https://maps.googleapis.com/maps/api/js?key=YOUR_GOOGLE_MAPS_API_KEY&callback=initMap"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/i18next/23.11.5/i18next.min.js"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());
    gtag('config', 'YOUR_GA_ID');
  </script>
  <style>
    :root {
      --bg-color: #f5f0e1; /* بيج قديم */
      --text-color: #4a3728; /* بني غامق */
      --header-bg: linear-gradient(90deg, #6b4e31, #4a3728); /* ترابي */
      --card-bg: #fff8e7; /* ورق قديم */
      --accent-color: #8a9a5b; /* أخضر زيتوني */
      --button-bg: #6b4e31;
      --button-hover: #4a3728;
    }
    [data-theme="dark"] {
      --bg-color: #2f2f2f;
      --text-color: #e6d9b7;
      --header-bg: linear-gradient(90deg, #3c2f2f, #2f2f2f);
      --card-bg: #4a3728;
      --accent-color: #a3b18a;
      --button-bg: #3c2f2f;
      --button-hover: #2f2f2f;
    }
    body {
      font-family: 'Amiri', serif;
      background: var(--bg-color);
      color: var(--text-color);
      transition: background 0.3s ease, color 0.3s ease;
      overflow-x: hidden;
    }
    header {
      background: var(--header-bg);
      color: #e6d9b7;
      padding: 40px 20px;
      text-align: center;
      position: relative;
      box-shadow: 0 4px 10px rgba(0, 0, 0, 0.3);
      border-bottom: 3px solid var(--accent-color);
    }
    header::before {
      content: '';
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAQAAAAECAYAAACp8Z5+AAAAG0lEQVR4nGNgYGBgYGD4//8/AzMzM4M5AwAAAP8AnP/7J1QAAAAASUVORK5CYII=') repeat; /* نسيج ورق قديم */
      opacity: 0.1;
      z-index: 0;
    }
    header h1, header p {
      position: relative;
      z-index: 1;
      text-shadow: 1px 1px 2px rgba(0, 0, 0, 0.4);
    }
    .theme-toggle, .lang-toggle {
      position: absolute;
      top: 20px;
      background: var(--accent-color);
      border: none;
      padding: 10px;
      border-radius: 50%;
      cursor: pointer;
      z-index: 2;
      transition: transform 0.3s ease;
    }
    .theme-toggle:hover, .lang-toggle:hover {
      transform: scale(1.1);
    }
    .theme-toggle { left: 20px; }
    .lang-toggle { left: 70px; }
    .nav-link {
      color: var(--text-color) !important;
      font-weight: bold;
      padding: 10px 20px;
      transition: color 0.3s ease, transform 0.3s ease;
    }
    .nav-link:hover {
      color: var(--accent-color) !important;
      transform: scale(1.1);
    }
    .ticker {
      background: var(--card-bg);
      padding: 15px;
      white-space: nowrap;
      overflow: hidden;
      direction: rtl;
      border-radius: 8px;
      box-shadow: 0 3px 8px rgba(0, 0, 0, 0.1);
      margin: 15px 0;
      font-size: 1.1rem;
      border: 1px solid var(--accent-color);
    }
    .ticker span {
      display: inline-block;
      padding-left: 100%;
      animation: scroll 12s linear infinite;
    }
    .ticker-warning {
      background: linear-gradient(90deg, var(--accent-color), #6b4e31);
      color: #e6d9b7;
      padding: 20px;
      font-size: 1.2rem;
      font-weight: bold;
      border-radius: 8px;
      box-shadow: 0 3px 10px rgba(0, 0, 0, 0.2);
      animation: pulse 2s infinite;
    }
    .ticker-warning a {
      color: #fff8e7;
      text-decoration: underline;
      margin-right: 10px;
    }
    .ticker-warning button {
      background: var(--button-bg);
      color: #e6d9b7;
      border: none;
      padding: 8px 15px;
      border-radius: 8px;
      cursor: pointer;
      transition: background 0.3s ease;
    }
    .ticker-warning button:hover {
      background: var(--button-hover);
    }
    @keyframes scroll {
      from { transform: translateX(0); }
      to { transform: translateX(-100%); }
    }
    @keyframes pulse {
      0% { opacity: 1; }
      50% { opacity: 0.8; }
      100% { opacity: 1; }
    }
    .service-folder {
      background: var(--card-bg);
      border-radius: 12px;
      padding: 25px;
      text-align: center;
      transition: transform 0.4s ease, box-shadow 0.4s ease;
      box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
      cursor: pointer;
      position: relative;
      overflow: hidden;
      border: 2px solid var(--accent-color);
    }
    .service-folder::before {
      content: '';
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      height: 5px;
      background: linear-gradient(90deg, var(--accent-color), #6b4e31);
      transition: height 0.3s ease;
    }
    .service-folder:hover::before {
      height: 100%;
      opacity: 0.1;
    }
    .service-folder:hover {
      transform: translateY(-10px);
      box-shadow: 0 10px 20px rgba(0, 0, 0, 0.2);
    }
    .service-folder i {
      font-size: clamp(2rem, 5vw, 2.5rem);
      color: var(--accent-color);
      margin-bottom: 15px;
      transition: transform 0.3s ease;
    }
    .service-folder:hover i {
      transform: scale(1.2);
    }
    .service-details {
      display: none;
      background: var(--card-bg);
      border-radius: 10px;
      padding: 20px;
      margin-top: 10px;
      box-shadow: 0 3px 10px rgba(0, 0, 0, 0.1);
      border: 1px solid var(--accent-color);
    }
    .service-details.active {
      display: block;
    }
    .sub-service {
      display: flex;
      align-items: center;
      padding: 10px;
      border-bottom: 1px solid var(--accent-color);
    }
    .sub-service i {
      font-size: 1.5rem;
      color: var(--accent-color);
      margin-left: 10px;
    }
    .game-container {
      display: flex;
      flex-direction: column;
      gap: 10px;
    }
    .game-btn {
      background: var(--button-bg);
      color: #e6d9b7;
      border: none;
      padding: 10px;
      border-radius: 8px;
      font-size: 1rem;
      cursor: pointer;
      transition: transform 0.3s ease;
    }
    .game-btn:hover {
      transform: scale(1.1);
      background: var(--button-hover);
    }
    .ai-chat {
      position: fixed;
      bottom: 20px;
      left: 20px;
      z-index: 1000;
    }
    .ai-chat-button {
      background: var(--button-bg);
      color: #e6d9b7;
      border: none;
      padding: 15px;
      border-radius: 50%;
      font-size: 1.5rem;
      cursor: pointer;
      box-shadow: 0 4px 10px rgba(0, 0, 0, 0.3);
      transition: transform 0.3s ease;
    }
    .ai-chat-button:hover {
      transform: scale(1.2);
    }
    .ai-chat-box {
      display: none;
      background: var(--card-bg);
      border-radius: 10px;
      padding: 20px;
      width: clamp(280px, 90vw, 350px);
      box-shadow: 0 5px 15px rgba(0, 0, 0, 0.2);
      position: absolute;
      bottom: 60px;
      left: 0;
      border: 1px solid var(--accent-color);
    }
    .ai-chat-box.active {
      display: block;
    }
    .ai-chat-box input {
      border-radius: 8px;
      border: 1px solid var(--accent-color);
      width: 100%;
      padding: 10px;
      margin-bottom: 10px;
    }
    .ai-chat-box .response {
      background: #f5f0e1;
      padding: 10px;
      border-radius: 8px;
      margin-top: 10px;
    }
    .suggestions {
      position: absolute;
      background: var(--card-bg);
      border: 1px solid var(--accent-color);
      border-radius: 5px;
      z-index: 1000;
      width: clamp(200px, 90%, 300px);
    }
    .suggestions div {
      padding: 10px;
      cursor: pointer;
    }
    .suggestions div:hover {
      background: #f5f0e1;
    }
    .urgent-btn {
      position: fixed;
      top: 20px;
      right: 20px;
      background: #a52a2a;
      color: white;
      padding: 10px 15px;
      border-radius: 5px;
      z-index: 1000;
      font-size: 1rem;
      transition: transform 0.3s ease;
    }
    .urgent-btn:hover {
      transform: scale(1.1);
    }
    footer {
      background: var(--header-bg);
      color: #e6d9b7;
      padding: 30px;
      text-align: center;
      box-shadow: 0 -4px 15px rgba(0, 0, 0, 0.2);
      border-top: 3px solid var(--accent-color);
    }
    footer a {
      color: var(--accent-color);
      margin: 0 15px;
      transition: color 0.3s ease;
    }
    footer a:hover {
      color: #6b4e31;
    }
    #mapContainer {
      height: 400px;
      border-radius: 10px;
      box-shadow: 0 3px 10px rgba(0, 0, 0, 0.1);
      border: 1px solid var(--accent-color);
    }
    #calendar {
      background: var(--card-bg);
      padding: 20px;
      border-radius: 10px;
      box-shadow: 0 3px 10px rgba(0, 0, 0, 0.1);
    }
    #countdown, #priceCalculator, #stories {
      background: var(--card-bg);
      padding: 20px;
      border-radius: 8px;
      margin: 20px 0;
      box-shadow: 0 3px 8px rgba(0, 0, 0, 0.1);
      border: 1px solid var(--accent-color);
    }
    @media (max-width: 768px) {
      header { padding: 30px 15px; }
      .theme-toggle, .lang-toggle { top: 15px; }
      .urgent-btn { top: 15px; right: 15px; font-size: 0.9rem; }
      .service-folder { margin-bottom: 15px; }
      .ticker-warning { font-size: 1rem; }
      .ai-chat-box { width: 280px; }
    }
  </style>
</head>
<body>
  <header>
    <button class="theme-toggle" id="themeToggle"><i class="fas fa-moon"></i></button>
    <button class="lang-toggle" id="langToggle"><i class="fas fa-globe"></i></button>
    <h1 data-i18n="header.title">بوابة قرية الخريطة</h1>
    <p data-i18n="header.description">قرية زراعية نابضة بالحياة على ضفاف نهر الفرات</p>
  </header>

  <nav class="nav justify-content-center bg-light py-3 shadow-sm">
    <a class="nav-link" href="#home" data-i18n="nav.home">الرئيسية</a>
    <a class="nav-link" href="#services" data-i18n="nav.services">الخدمات</a>
    <a class="nav-link" href="#about" data-i18n="nav.about">عن القرية</a>
    <a class="nav-link" href="#events" data-i18n="nav.events">الفعاليات</a>
    <a class="nav-link" href="#feedback" data-i18n="nav.feedback">التعليقات</a>
    <a class="nav-link" href="#stories" data-i18n="nav.stories">حكايات القرية</a>
    <a class="nav-link" href="https://alikhbariah.com/" target="_blank" data-i18n="nav.news">الأخبار</a>
  </nav>

  <button class="urgent-btn" data-bs-toggle="modal" data-bs-target="#urgentModal" data-i18n="urgent.button">طلب عاجل</button>

  <div class="container my-3 position-relative">
    <input type="text" class="form-control" id="searchInput" placeholder="ابحث عن خدمة..." data-i18n="[placeholder]search.placeholder">
    <select id="filterCategory" class="form-select mt-2">
      <option value="all" data-i18n="filter.all">الكل</option>
      <option value="medical" data-i18n="filter.medical">طبية</option>
      <option value="municipality" data-i18n="filter.municipality">بلدية</option>
      <option value="education" data-i18n="filter.education">تعليم</option>
      <option value="agriculture" data-i18n="filter.agriculture">زراعة</option>
      <option value="transport" data-i18n="filter.transport">نقل</option>
      <option value="donation" data-i18n="filter.donation">تبرع</option>
    </select>
  </div>

  <div class="ticker"><span><i class="fas fa-bullhorn me-2"></i> <span id="announcement" data-i18n="ticker.announcement">الموقع قيد الإنشاء بواسطة أبو خالد</span></span></div>
  <div class="ticker ticker-warning">
    <span><i class="fas fa-bullhorn me-2"></i> <span data-i18n="ticker.warning">يرجى نشر رابط الموقع:</span> <a href="https://your-site-url.com" target="_blank">اضغط هنا</a></span>
    <button onclick="navigator.clipboard.write('https://your-site-url.com'); alert(i18next.t('ticker.copy_alert'))" data-i18n="[innerHTML]ticker.copy_button">نسخ الرابط</button>
  </div>

  <section class="container my-5" id="home">
    <h3 class="text-center mb-4" style="color: var(--text-color);" data-i18n="home.title">أخبار وخدمات جديدة</h3>
    <div class="row g-4">
      <div class="col-md-4 col-sm-6">
        <div class="service-folder">
          <i class="fas fa-broom"></i>
          <h5 data-i18n="home.cleaning">حملة نظافة عامة</h5>
          <p data-i18n="home.cleaning_desc">حملة تنظيف القرية بالتعاون مع الشباب</p>
        </div>
      </div>
      <div class="col-md-4 col-sm-6">
        <div class="service-folder">
          <i class="fas fa-users"></i>
          <h5 data-i18n="home.youth">فعاليات شبابية</h5>
          <p data-i18n="home.youth_desc">فعاليات ترفيهية وثقافية لشباب القرية</p>
        </div>
      </div>
      <div class="col-md-4 col-sm-6">
        <div class="service-folder">
          <i class="fas fa-hand-holding-heart"></i>
          <h5 data-i18n="home.community">خدمات مجتمعية</h5>
          <p data-i18n="home.community_desc">دعم المجتمع من خلال مبادرات خيرية</p>
        </div>
      </div>
    </div>
  </section>

  <section class="container my-5" id="services">
    <h3 class="text-center mb-4" style="color: var(--text-color);" data-i18n="services.title">جميع الخدمات في قرية الخريطة</h3>
    <div class="row g-4" id="servicesContainer">
      <div class="col-md-4 col-sm-6" data-category="medical">
        <div class="service-folder" onclick="toggleDetails('medical')" data-service="medical">
          <i class="fas fa-hospital"></i>
          <h5 data-i18n="services.medical">الخدمات الطبية</h5>
        </div>
        <div class="service-details" id="medical">
          <div class="sub-service"><i class="fas fa-prescription-bottle"></i> <span data-i18n="services.pharmacy">الصيدلية</span></div>
          <div class="sub-service"><i class="fas fa-hospital"></i> <span data-i18n="services.hospital">المستشفى</span></div>
          <div class="sub-service"><i class="fas fa-clinic-medical"></i> <span data-i18n="services.clinic">المستوصف</span></div>
        </div>
      </div>
      <div class="col-md-4 col-sm-6" data-category="municipality">
        <div class="service-folder" onclick="toggleDetails('municipality')" data-service="municipality">
          <i class="fas fa-city"></i>
          <h5 data-i18n="services.municipality">البلدية</h5>
        </div>
        <div class="service-details" id="municipality">
          <div class="sub-service">
            <i class="fas fa-calendar-check"></i> <span data-i18n="services.booking">حجز مواعيد</span>
            <button class="btn btn-sm btn-primary ms-2" data-bs-toggle="modal" data-bs-target="#bookingModal" data-i18n="[innerHTML]services.book_now">احجز الآن</button>
          </div>
          <div class="sub-service"><i class="fas fa-file-alt"></i> <span data-i18n="services.admin">الخدمات الإدارية</span></div>
          <div class="sub-service"><i class="fas fa-users"></i> <span data-i18n="services.support">دعم المواطنين</span></div>
        </div>
      </div>
      <div class="col-md-4 col-sm-6" data-category="security">
        <div class="service-folder" onclick="toggleDetails('security')" data-service="security">
          <i class="fas fa-shield-alt"></i>
          <h5 data-i18n="services.security">الأمن</h5>
        </div>
        <div class="service-details" id="security">
          <div class="sub-service"><i class="fas fa-shield-alt"></i> <span data-i18n="services.police">قسم الشرطة</span></div>
          <div class="sub-service"><i class="fas fa-user-shield"></i> <span data-i18n="services.protection">خدمات الحماية المجتمعية</span></div>
        </div>
      </div>
      <div class="col-md-4 col-sm-6" data-category="education">
        <div class="service-folder" onclick="toggleDetails('education')" data-service="education">
          <i class="fas fa-school"></i>
          <h5 data-i18n="services.education">التعليم</h5>
        </div>
        <div class="service-details" id="education">
          <div class="sub-service"><i class="fas fa-school"></i> <span data-i18n="services.school">المدرسة</span></div>
          <div class="sub-service"><i class="fas fa-graduation-cap"></i> <span data-i18n="services.high_school">الثانوية</span></div>
          <div class="sub-service"><i class="fas fa-chalkboard-teacher"></i> <span data-i18n="services.primary">الابتدائية</span></div>
          <div class="sub-service"><i class="fas fa-book-open"></i> <span data-i18n="services.courses">تعليم الدورات</span></div>
        </div>
      </div>
      <div class="col-md-4 col-sm-6" data-category="agriculture">
        <div class="service-folder" onclick="toggleDetails('agriculture')" data-service="agriculture">
          <i class="fas fa-tractor"></i>
          <h5 data-i18n="services.agriculture">الزراعة</h5>
        </div>
        <div class="service-details" id="agriculture">
          <div class="sub-service"><i class="fas fa-tractor"></i> <span data-i18n="services.farmers">دعم المزارعين</span></div>
          <div class="sub-service"><i class="fas fa-seedling"></i> <span data-i18n="services.consulting">استشارات زراعية حديثة</span></div>
          <div class="sub-service"><i class="fas fa-leaf"></i> <span data-i18n="services.fertilizers">دعم الأسمدة</span></div>
          <div class="sub-service"><i class="fas fa-water"></i> <span data-i18n="services.irrigation">مياه السقي</span></div>
        </div>
      </div>
      <div class="col-md-4 col-sm-6" data-category="transport">
        <div class="service-folder" onclick="toggleDetails('transport')" data-service="transport">
          <i class="fas fa-bus"></i>
          <h5 data-i18n="services.transport">النقل</h5>
        </div>
        <div class="service-details" id="transport">
          <div class="sub-service"><i class="fas fa-bus"></i> <span data-i18n="services.public_transport">خدمات النقل العام</span></div>
          <div class="sub-service"><i class="fas fa-ticket-alt"></i> <span data-i18n="services.ticket">حجز تذكرة</span></div>
          <div class="sub-service"><i class="fas fa-taxi"></i> <span data-i18n="services.taxi">طلب سيارة أجرة</span></div>
        </div>
      </div>
      <div class="col-md-4 col-sm-6" data-category="donation">
        <div class="service-folder" onclick="toggleDetails('donation')" data-service="donation">
          <i class="fas fa-hand-holding-heart"></i>
          <h5 data-i18n="services.donation">التبرع</h5>
        </div>
        <div class="service-details" id="donation">
          <div class="sub-service">
            <i class="fas fa-hand-holding-heart"></i> <span data-i18n="services.charity">تبرع لجمعيات خيرية</span>
            <a href="https://www.paypal.com/donate?hosted_button_id=YOUR_BUTTON_ID" class="btn btn-sm btn-primary ms-2" data-i18n="[innerHTML]services.donate_now">تبرع الآن</a>
          </div>
          <div class="sub-service">
            <i class="fas fa-donate"></i> <span data-i18n="services.schools_donation">تبرع للمدارس</span>
            <a href="https://www.paypal.com/donate?hosted_button_id=YOUR_BUTTON_ID" class="btn btn-sm btn-primary ms-2" data-i18n="[innerHTML]services.donate_now">تبرع الآن</a>
          </div>
        </div>
      </div>
      <div class="col-md-4 col-sm-6" data-category="game">
        <div class="service-folder" onclick="toggleDetails('game')" data-service="game">
          <i class="fas fa-gamepad"></i>
          <h5 data-i18n="services.rps_game">لعبة حجرة-ورقة-مقص</h5>
        </div>
        <div class="service-details" id="game">
          <div class="sub-service">
            <div class="game-container">
              <button class="game-btn" onclick="playGame('حجرة')"><i class="fas fa-hand-rock"></i> <span data-i18n="game.rock">حجرة</span></button>
              <button class="game-btn" onclick="playGame('ورقة')"><i class="fas fa-hand-paper"></i> <span data-i18n="game.paper">ورقة</span></button>
              <button class="game-btn" onclick="playGame('مقص')"><i class="fas fa-hand-scissors"></i> <span data-i18n="game.scissors">مقص</span></button>
              <p id="gameResult" data-i18n="game.result"></p>
              <p id="gameScore" data-i18n="game.score">النقاط - أنت: 0 | الكمبيوتر: 0</p>
            </div>
          </div>
        </div>
      </div>
      <div class="col-md-4 col-sm-6" data-category="quiz">
        <div class="service-folder" onclick="toggleDetails('quiz')" data-service="quiz">
          <i class="fas fa-question-circle"></i>
          <h5 data-i18n="services.quiz">اختبار معلومات القرية</h5>
        </div>
        <div class="service-details" id="quiz">
          <div class="sub-service">
            <div id="quizContainer">
              <p id="quizQuestion" data-i18n="quiz.question"></p>
              <div id="quizOptions"></div>
              <p id="quizResult"></p>
              <p id="quizScore" data-i18n="quiz.score">النقاط: 0</p>
            </div>
          </div>
        </div>
      </div>
    </div>
  </section>

  <section class="container my-5" id="about">
    <h3 class="text-center mb-4" style="color: var(--text-color);" data-i18n="about.title">عن قرية الخريطة</h3>
    <div class="row g-4">
      <div class="col-md-12">
        <div class="service-folder">
          <i class="fas fa-leaf"></i>
          <h5 data-i18n="about.history">تاريخ القرية</h5>
          <p data-i18n="about.history_desc">تأسست قرية الخريطة على ضفاف نهر الفرات، وتشتهر بتربتها الخصبة وزراعتها المتنوعة.</p>
        </div>
      </div>
    </div>
  </section>

  <section class="container my-5" id="stories">
    <h3 class="text-center mb-4" style="color: var(--text-color);" data-i18n="stories.title">حكايات القرية</h3>
    <div id="stories">
      <p id="storyText" data-i18n="stories.text">في يوم من الأيام، تجمع أهل القرية حول النهر للاحتفال بموسم الحصاد...</p>
      <button class="btn btn-sm btn-primary" onclick="randomStory()" data-i18n="stories.read_more">اقرأ حكاية أخرى</button>
    </div>
  </section>

  <section class="container my-5" id="priceCalculator">
    <h3 class="text-center mb-4" style="color: var(--text-color);" data-i18n="price.title">محاكي الأسعار الزراعية</h3>
    <div id="priceCalculator">
      <select id="cropType" class="form-select mb-2">
        <option value="wheat" data-i18n="price.wheat">قمح</option>
        <option value="barley" data-i18n="price.barley">شعير</option>
        <option value="dates" data-i18n="price.dates">تمر</option>
      </select>
      <input type="number" id="cropQuantity" class="form-control mb-2" placeholder="الكمية (طن)" data-i18n="[placeholder]price.quantity">
      <button class="btn btn-primary" onclick="calculatePrice()" data-i18n="price.calculate">احسب السعر</button>
      <p id="priceResult" data-i18n="price.result"></p>
    </div>
  </section>

  <section class="container my-5" id="events">
    <h3 class="text-center mb-4" style="color: var(--text-color);" data-i18n="events.title">الفعاليات القادمة</h3>
    <div id="countdown"></div>
    <div id="calendar"></div>
  </section>

  <section class="container my-5" id="feedback">
    <h3 class="text-center mb-4" style="color: var(--text-color);" data-i18n="feedback.title">التعليقات</h3>
    <form id="feedbackForm" action="https://formspree.io/f/your-form-id" method="POST">
      <div class="mb-3">
        <label class="form-label" data-i18n="feedback.name">الاسم</label>
        <input type="text" class="form-control" name="name" required>
      </div>
      <div class="mb-3">
        <label class="form-label" data-i18n="feedback.comment">التعليق</label>
        <textarea class="form-control" name="comment" rows="5" required></textarea>
      </div>
      <button type="submit" class="btn btn-primary" data-i18n="feedback.submit">إرسال</button>
    </form>
  </section>

  <div class="modal fade" id="urgentModal" tabindex="-1">
    <div class="modal-dialog">
      <div class="modal-content" style="background: var(--card-bg); border: 1px solid var(--accent-color);">
        <div class="modal-header">
          <h5 class="modal-title" data-i18n="urgent.title">طلب عاجل</h5>
          <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
        </div>
        <div class="modal-body">
          <form id="urgentForm" action="https://formspree.io/f/your-form-id" method="POST">
            <div class="mb-3">
              <label class="form-label" data-i18n="urgent.name">الاسم</label>
              <input type="text" class="form-control" name="name" required>
            </div>
            <div class="mb-3">
              <label class="form-label" data-i18n="urgent.request">تفاصيل الطلب</label>
              <textarea class="form-control" name="request" required></textarea>
            </div>
            <button type="submit" class="btn btn-primary" data-i18n="urgent.submit">إرسال</button>
          </form>
        </div>
      </div>
    </div>
  </div>

  <div class="ai-chat">
    <button class="ai-chat-button" onclick="toggleChat()"><i class="fas fa-headset"></i></button>
    <div class="ai-chat-box" id="aiChatBox">
      <h5 data-i18n="chat.title">مساعد القرية</h5>
      <p class="response" data-i18n="chat.welcome">مرحبًا! اسألني عن القرية أو الخدمات!</p>
      <div id="chatSuggestions">
        <button class="btn btn-sm btn-outline-primary m-1" onclick="sendAIQuery('ما موعد الفعالية القادمة؟')" data-i18n="chat.suggest_event">موعد الفعالية</button>
        <button class="btn btn-sm btn-outline-primary m-1" onclick="sendAIQuery('كيف أحجز موعد؟')" data-i18n="chat.suggest_booking">حجز موعد</button>
        <button class="btn btn-sm btn-outline-primary m-1" onclick="sendAIQuery('ما أسعار المحاصيل؟')" data-i18n="chat.suggest_price">أسعار المحاصيل</button>
      </div>
      <input type="text" id="aiInput" placeholder="اكتب سؤالك..." data-i18n="[placeholder]chat.placeholder">
      <button class="btn btn-sm btn-danger mt-2" onclick="clearChatHistory()" data-i18n="chat.clear">مسح السجل</button>
      <div class="response" id="aiResponse"></div>
    </div>
  </div>

  <footer>
    <p data-i18n="footer.copyright">© 2025 قرية الخريطة</p>
    <p id="quote" data-i18n="footer.quote">"الزراعة هي عماد القرية."</p>
    <div>
      <a href="#"><i class="fab fa-facebook"></i></a>
      <a href="#"><i class="fab fa-twitter"></i></a>
      <a href="#"><i class="fab fa-instagram"></i></a>
    </div>
  </footer>

  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
  <script>
    let playerScore = 0, computerScore = 0, quizScore = 0;
    let chatHistory = JSON.parse(localStorage.getItem('chatHistory')) || [];

    i18next.init({
      lng: 'ar',
      resources: {
        ar: {
          translation: {
            "header.title": "بوابة قرية الخريطة",
            "header.description": "قرية زراعية نابضة بالحياة على ضفاف نهر الفرات",
            "nav.home": "الرئيسية",
            "nav.services": "الخدمات",
            "nav.about": "عن القرية",
            "nav.events": "الفعاليات",
            "nav.feedback": "التعليقات",
            "nav.stories": "حكايات القرية",
            "nav.news": "الأخبار",
            "search.placeholder": "ابحث عن خدمة...",
            "filter.all": "الكل",
            "filter.medical": "طبية",
            "filter.municipality": "بلدية",
            "filter.education": "تعليم",
            "filter.agriculture": "زراعة",
            "filter.transport": "نقل",
            "filter.donation": "تبرع",
            "ticker.announcement": "الموقع قيد الإنشاء بواسطة أبو خالد",
            "ticker.warning": "يرجى نشر رابط الموقع:",
            "ticker.copy_button": "نسخ الرابط",
            "ticker.copy_alert": "تم نسخ الرابط!",
            "home.title": "أخبار وخدمات جديدة",
            "home.cleaning": "حملة نظافة عامة",
            "home.cleaning_desc": "حملة تنظيف القرية بالتعاون مع الشباب",
            "home.youth": "فعاليات شبابية",
            "home.youth_desc": "فعاليات ترفيهية وثقافية لشباب القرية",
            "home.community": "خدمات مجتمعية",
            "home.community_desc": "دعم المجتمع من خلال مبادرات خيرية",
            "services.title": "جميع الخدمات في قرية الخريطة",
            "services.medical": "الخدمات الطبية",
            "services.pharmacy": "الصيدلية",
            "services.hospital": "المستشفى",
            "services.clinic": "المستوصف",
            "services.municipality": "البلدية",
            "services.booking": "حجز مواعيد",
            "services.book_now": "احجز الآن",
            "services.admin": "الخدمات الإدارية",
            "services.support": "دعم المواطنين",
            "services.security": "الأمن",
            "services.police": "قسم الشرطة",
            "services.protection": "خدمات الحماية المجتمعية",
            "services.education": "التعليم",
            "services.school": "المدرسة",
            "services.high_school": "الثانوية",
            "services.primary": "الابتدائية",
            "services.courses": "تعليم الدورات",
            "services.agriculture": "الزراعة",
            "services.farmers": "دعم المزارعين",
            "services.consulting": "استشارات زراعية حديثة",
            "services.fertilizers": "دعم الأسمدة",
            "services.irrigation": "مياه السقي",
            "services.transport": "النقل",
            "services.public_transport": "خدمات النقل العام",
            "services.ticket": "حجز تذكرة",
            "services.taxi": "طلب سيارة أجرة",
            "services.donation": "التبرع",
            "services.charity": "تبرع لجمعيات خيرية",
            "services.schools_donation": "تبرع للمدارس",
            "services.donate_now": "تبرع الآن",
            "services.rps_game": "لعبة حجرة-ورقة-مقص",
            "game.rock": "حجرة",
            "game.paper": "ورقة",
            "game.scissors": "مقص",
            "game.score": "النقاط - أنت: 0 | الكمبيوتر: 0",
            "services.quiz": "اختبار معلومات القرية",
            "quiz.score": "النقاط: 0",
            "about.title": "عن قرية الخريطة",
            "about.history": "تاريخ القرية",
            "about.history_desc": "تأسست قرية الخريطة على ضفاف نهر الفرات، وتشتهر بتربتها الخصبة وزراعتها المتنوعة.",
            "stories.title": "حكايات القرية",
            "stories.text": "في يوم من الأيام، تجمع أهل القرية حول النهر...",
            "stories.read_more": "اقرأ حكاية أخرى",
            "price.title": "محاكي الأسعار الزراعية",
            "price.wheat": "قمح",
            "price.barley": "شعير",
            "price.dates": "تمر",
            "price.quantity": "الكمية (طن)",
            "price.calculate": "احسب السعر",
            "price.result": "",
            "events.title": "الفعاليات القادمة",
            "feedback.title": "التعليقات",
            "feedback.name": "الاسم",
            "feedback.comment": "التعليق",
            "feedback.submit": "إرسال",
            "urgent.button": "طلب عاجل",
            "urgent.title": "طلب عاجل",
            "urgent.name": "الاسم",
            "urgent.request": "تفاصيل الطلب",
            "urgent.submit": "إرسال",
            "chat.title": "مساعد القرية",
            "chat.welcome": "مرحبًا! اسألني عن القرية أو الخدمات!",
            "chat.suggest_event": "موعد الفعالية",
            "chat.suggest_booking": "حجز موعد",
            "chat.suggest_price": "أسعار المحاصيل",
            "chat.placeholder": "اكتب سؤالك...",
            "chat.clear": "مسح السجل",
            "footer.copyright": "© 2025 قرية الخريطة",
            "footer.quote": "الزراعة هي عماد القرية."
          }
        },
        en: {
          translation: {
            "header.title": "Al-Kharita Village Portal",
            "header.description": "A vibrant agricultural village on the Euphrates",
            "nav.home": "Home",
            "nav.services": "Services",
            "nav.about": "About",
            "nav.events": "Events",
            "nav.feedback": "Feedback",
            "nav.stories": "Village Tales",
            "nav.news": "News",
            "search.placeholder": "Search for a service...",
            "filter.all": "All",
            "filter.medical": "Medical",
            "filter.municipality": "Municipality",
            "filter.education": "Education",
            "filter.agriculture": "Agriculture",
            "filter.transport": "Transport",
            "filter.donation": "Donation",
            "ticker.announcement": "Website under construction by Abu Khaled",
            "ticker.warning": "Please share the website link:",
            "ticker.copy_button": "Copy Link",
            "ticker.copy_alert": "Link copied!",
            "home.title": "News and New Services",
            "home.cleaning": "General Cleaning Campaign",
            "home.cleaning_desc": "Village cleaning campaign with youth collaboration",
            "home.youth": "Youth Events",
            "home.youth_desc": "Entertainment and cultural events for village youth",
            "home.community": "Community Services",
            "home.community_desc": "Community support through charitable initiatives",
            "services.title": "All Services in Al-Kharita Village",
            "services.medical": "Medical Services",
            "services.pharmacy": "Pharmacy",
            "services.hospital": "Hospital",
            "services.clinic": "Clinic",
            "services.municipality": "Municipality",
            "services.booking": "Appointment Booking",
            "services.book_now": "Book Now",
            "services.admin": "Administrative Services",
            "services.support": "Citizen Support",
            "services.security": "Security",
            "services.police": "Police Station",
            "services.protection": "Community Protection Services",
            "services.education": "Education",
            "services.school": "School",
            "services.high_school": "High School",
            "services.primary": "Primary School",
            "services.courses": "Training Courses",
            "services.agriculture": "Agriculture",
            "services.farmers": "Farmer Support",
            "services.consulting": "Modern Agricultural Consulting",
            "services.fertilizers": "Fertilizer Support",
            "services.irrigation": "Irrigation Water",
            "services.transport": "Transport",
            "services.public_transport": "Public Transport Services",
            "services.ticket": "Ticket Booking",
            "services.taxi": "Private Taxi Request",
            "services.donation": "Donation",
            "services.charity": "Donate to Charities",
            "services.schools_donation": "Donate to Schools",
            "services.donate_now": "Donate Now",
            "services.rps_game": "Rock-Paper-Scissors Game",
            "game.rock": "Rock",
            "game.paper": "Paper",
            "game.scissors": "Scissors",
            "game.score": "Score - You: 0 | Computer: 0",
            "services.quiz": "Village Knowledge Quiz",
            "quiz.score": "Score: 0",
            "about.title": "About Al-Kharita Village",
            "about.history": "Village History",
            "about.history_desc": "Al-Kharita Village was established on the Euphrates, known for its fertile soil and diverse agriculture.",
            "stories.title": "Village Tales",
            "stories.text": "One day, villagers gathered by the river to celebrate the harvest...",
            "stories.read_more": "Read Another Tale",
            "price.title": "Agricultural Price Calculator",
            "price.wheat": "Wheat",
            "price.barley": "Barley",
            "price.dates": "Dates",
            "price.quantity": "Quantity (tons)",
            "price.calculate": "Calculate Price",
            "price.result": "",
            "events.title": "Upcoming Events",
            "feedback.title": "Feedback",
            "feedback.name": "Name",
            "feedback.comment": "Comment",
            "feedback.submit": "Submit",
            "urgent.button": "Urgent Request",
            "urgent.title": "Urgent Request",
            "urgent.name": "Name",
            "urgent.request": "Request Details",
            "urgent.submit": "Submit",
            "chat.title": "Village Assistant",
            "chat.welcome": "Hello! Ask me about the village or services!",
            "chat.suggest_event": "Event Schedule",
            "chat.suggest_booking": "Book Appointment",
            "chat.suggest_price": "Crop Prices",
            "chat.placeholder": "Type your question...",
            "chat.clear": "Clear History",
            "footer.copyright": "© 2025 Al-Kharita Village",
            "footer.quote": "Agriculture is the backbone of the village."
          }
        }
      }
    }, () => {
      document.querySelectorAll('[data-i18n]').forEach(elem => {
        const key = elem.getAttribute('data-i18n');
        if (key.includes('[placeholder]')) elem.placeholder = i18next.t(key.replace('[placeholder]', ''));
        else if (key.includes('[innerHTML]')) elem.innerHTML = i18next.t(key.replace('[innerHTML]', ''));
        else elem.textContent = i18next.t(key);
      });
    });

    function toggleDetails(id) {
      const details = document.getElementById(id);
      const isActive = details.classList.contains('active');
      document.querySelectorAll('.service-details').forEach(detail => detail.classList.remove('active'));
      if (!isActive) details.classList.add('active');
    }

    function playGame(playerChoice) {
      const choices = ['حجرة', 'ورقة', 'مقص'];
      const computerChoice = choices[Math.floor(Math.random() * 3)];
      let result = '';
      if (playerChoice === computerChoice) {
        result = 'تعادل!';
      } else if (
        (playerChoice === 'حجرة' && computerChoice === 'مقص') ||
        (playerChoice === 'ورقة' && computerChoice === 'حجرة') ||
        (playerChoice === 'مقص' && computerChoice === 'ورقة')
      ) {
        result = 'فزت!';
        playerScore++;
      } else {
        result = 'خسرت!';
        computerScore++;
      }
      document.getElementById('gameResult').textContent = `أنت: ${playerChoice} | الكمبيوتر: ${computerChoice} - ${result}`;
      document.getElementById('gameScore').textContent = `النقاط - أنت: ${playerScore} | الكمبيوتر: ${computerScore}`;
    }

    function loadQuiz() {
      const questions = [
        {
          question: 'ما هو النهر الذي تقع عليه قرية الخريطة؟',
          options: ['الفرات', 'دجلة', 'النيل'],
          answer: 'الفرات'
        },
        {
          question: 'ما هو المحصول الرئيسي في القرية؟',
          options: ['قمح', 'تمر', 'شعير'],
          answer: 'قمح'
        }
      ];
      let currentQuestion = 0;
      const questionElement = document.getElementById('quizQuestion');
      const optionsElement = document.getElementById('quizOptions');
      const resultElement = document.getElementById('quizResult');
      const scoreElement = document.getElementById('quizScore');

      function loadQuestion() {
        const q = questions[currentQuestion];
        questionElement.textContent = q.question;
        optionsElement.innerHTML = '';
        q.options.forEach(option => {
          const button = document.createElement('button');
          button.className = 'btn btn-outline-primary m-1';
          button.textContent = option;
          button.onclick = () => checkAnswer(option);
          optionsElement.appendChild(button);
        });
      }

      function checkAnswer(option) {
        const q = questions[currentQuestion];
        if (option === q.answer) {
          quizScore++;
          resultElement.textContent = 'إجابة صحيحة!';
        } else {
          resultElement.textContent = 'إجابة خاطئة!';
        }
        scoreElement.textContent = `النقاط: ${quizScore}`;
        currentQuestion++;
        if (currentQuestion < questions.length) {
          setTimeout(loadQuestion, 1000);
        } else {
          resultElement.textContent = 'انتهى الاختبار!';
          optionsElement.innerHTML = '';
        }
      }

      loadQuestion();
    }

    function randomStory() {
      const stories = [
        'في يوم من الأيام، تجمع أهل القرية حول النهر للاحتفال بموسم الحصاد...',
        'يقال إن شجرة الزيتون القديمة في القرية عمرها 300 عام...',
        'كان أبو علي يروي قصص الحصاد كل ليلة...',
        'في ليلة مقمرة، تجمع الشباب لسماع حكايات الجدود...'
      ];
      const random = stories[Math.floor(Math.random() * stories.length)];
      document.getElementById('storyText').textContent = random;
    }

    function calculatePrice() {
      const crop = document.getElementById('cropType').value;
      const quantity = parseFloat(document.getElementById('cropQuantity').value) || 0;
      const prices = { wheat: 300, barley: 250, dates: 500 };
      const total = quantity * prices[crop];
      document.getElementById('priceResult').textContent = total ? `السعر التقديري: ${total} دولار` : 'أدخل كمية صالحة!';
    }

    function startCountdown() {
      const nextEvent = new Date('2025-06-10T00:00:00');
      setInterval(() => {
        const now = new Date();
        const diff = nextEvent - now;
        if (diff <= 0) {
          document.getElementById('countdown').textContent = 'الفعالية بدأت!';
          return;
        }
        const days = Math.floor(diff / (1000 * 60 * 60 * 24));
        const hours = Math.floor((diff % (1000 * 60 * 60 * 24)) / (1000 * 60 * 60));
        const minutes = Math.floor((diff % (1000 * 60 * 60)) / (1000 * 60));
        document.getElementById('countdown').textContent = `الفعالية القادمة بعد: ${days} يوم، ${hours} ساعة، ${minutes} دقيقة`;
      }, 1000);
    }

    function randomQuote() {
      const quotes = [
        'الزراعة هي عماد القرية.',
        'نهر الفرات يروي أرضنا وقلوبنا.',
        'بالتعاون تبنى القرى.',
        'الأرض تعطي لمن يزرعها بحب.'
      ];
      document.getElementById('quote').textContent = quotes[Math.floor(Math.random() * quotes.length)];
    }

    function toggleChat() {
      const chatBox = document.getElementById('aiChatBox');
      chatBox.classList.toggle('active');
    }

    function sendAIQuery(text) {
      const input = text || document.getElementById('aiInput').value.toLowerCase();
      document.getElementById('aiInput').value = input;
      const responseDiv = document.getElementById('aiResponse');
      let response = 'عذرًا، حاول صياغة السؤال بطريقة أخرى!';
      if (input.includes('موعد') || input.includes('فعالية')) {
        response = 'الفعالية القادمة يوم 10 يونيو 2025!';
      } else if (input.includes('حجز')) {
        response = 'اضغط "احجز الآن" في قسم البلدية.';
      } else if (input.includes('أسعار') || input.includes('محاصيل')) {
        response = 'استخدم محاكي الأسعار الزراعية في القسم المخصص!';
      }
      chatHistory.push({ user: input, response });
      localStorage.setItem('chatHistory', JSON.stringify(chatHistory));
      responseDiv.innerHTML = response;
      document.getElementById('aiInput').value = '';
    }

    function clearChatHistory() {
      chatHistory = [];
      localStorage.removeItem('chatHistory');
      document.getElementById('aiResponse').innerHTML = '';
    }

    function initMap() {
      const village = { lat: 35.6895, lng: 39.8279 }; // إحداثيات وهمية
      const map = new google.maps.Map(document.getElementById('mapContainer'), {
        zoom: 12,
        center: village
      });
      new google.maps.Marker({
        position: village,
        map: map,
        title: 'قرية الخريطة'
      });
    }

    function initCalendar() {
      const calendarEl = document.getElementById('calendar');
      const calendar = new FullCalendar.Calendar(calendarEl, {
        initialView: 'dayGridMonth',
        events: [
          { title: 'حملة زراعة', date: '2025-06-10' },
          { title: 'يوم الشباب', date: '2025-06-15' }
        ]
      });
      calendar.render();
    }

    function filterServices() {
      const searchInput = document.getElementById('searchInput').value.toLowerCase();
      const category = document.getElementById('filterCategory').value;
      const services = document.querySelectorAll('#servicesContainer > div');
      services.forEach(service => {
        const title = service.querySelector('h5').textContent.toLowerCase();
        const serviceCategory = service.getAttribute('data-category');
        const matchesSearch = title.includes(searchInput);
        const matchesCategory = category === 'all' || serviceCategory === category;
        service.style.display = matchesSearch && matchesCategory ? '' : 'none';
      });
    }

    document.addEventListener('DOMContentLoaded', () => {
      randomStory();
      randomQuote();
      startCountdown();
      initCalendar();
      loadQuiz();
      document.getElementById('searchInput').addEventListener('input', filterServices);
      document.getElementById('filterCategory').addEventListener('change', filterServices);
    });
  </script>
</body>
</html>